---
title: Fluent_Python - PySlicing(二)
date: 2017-08-30 14:28:01
categories: Notes
tags: [Python, notes]
---

## Augmented assignment with sequences

- +=
- *=

这两个操作符根据第一个操作对象的类型，赋值的方式过程有所不同。

+= 使用特殊方法`__iadd__`实现这个功能。
*= 使用特殊方法`__imul__`实现这个功能。

如果该类型中实现了这个方法，则调用这个方法，否则退回去调用`__add__`生成一个新对象，然后重新赋值给第一个运算对象。
依据`__iadd__`是否可用，第一个运算对象有可能发生了改变，也可能没有发生改变。

对于可变序列，最好实现这个`__iadd__`特殊方法，使得+=就地产生作用。不可变可变序列，是不可能达到这样子作用的了。

上述阐述对于 *= 操作符，同样适用。

示例代码：
```bash
>>> l = [1, 2, 3] # 可变序列 l
>>> id(l) # l的内存起始地址
140129474567560
>>> l *= 2
>>> id(l)
140129474567560
>>> l
[1, 2, 3, 1, 2, 3]
>>> t = (1, 3, 4) # 非可变序列 t
>>> id(t)
140129474521440 # t 的起始内存地址
>>> t *= 2
>>> t
(1, 3, 4, 1, 3, 4)
>>> id(t)  # 新的非可变序列的内存起始地址
140129474508184
```
