---
title: Name Resolution
date: 2019-08-24 22:20:28
categories: Sams-Teach-yourself-TCP/IP-in-24-hours
tags: [notes, TCP/IP, Networks]
---

本文目的：

- 解释如何进行域名解析
- 解释主机名（hostname），域名和FQDNs的区别
- 描述主机名解析
- 描述DNS名字解析
- 描述在某些遗留微软网络上使用的NetBIOS名字解析

## What is Name Resolution

主机名系统是在TCP/IP历史上早期开发的简单的名字解析技术。系统中，每台计算机被分配给一个称为**主机名**的含有字母数字的名字。如果操作系统希望是一个IP地址的时候却碰上一个字母数字名字，则操作系统会查询一个**hosts文件**。hosts文件是一个包含主机名和IP地址关联的列表。如果字母数字名字在主机名列表上，计算机读取和名字相关联的IP地址。然后计算机使用相关的IP地址替换命令中主机名并且执行命令。

![93625dcb59ed467d.svg](https://i.quantuminit.com/93625dcb59ed467d.svg)

- 在每组特殊的域名服务器之间分发名字解析的责任。名字解析服务器维护定义了名字到地址关联的表。
- 授权本地名字解析权利给本地管理员。换句话说，就是不维护一份所有名字到地址关联表的中心化，主要版本，让网络A上个一个管理员负责网络A上的名字解析，以及让网络B上的管理员管理网络B上的名字解析。通过那样子的方式，每个单独的网络上的管理员负责网络上的任何更新也要负责确保那些更新反应到名字解析的基础设施。

以上两点优先级主导了域名系统（DNS）的开发。DNS将名字空间分割成称为域名的层次实体。域名可以和主机包含在一起，称之为主机域名全称（FQDN）。例如，主机名是www，且在域名quantuminit.com中，则构成的FQDN是www.quantuminit.com。

## Name Resolution Using Hosts Files

操作系统支持TCP/IP识别hosts文件并且在需要很少或者没有来自用户的干预下用它来进行名字解析。根据实现方式，配置主机名的细节也不相同。步骤大致如下：

1. 给每台计算机分配一个IP地址以及主机名
2. 创建一个映射IP地址到每台计算机的主机名的host文件。host文件经常命名为hosts，尽管有些实现使用的文件名为hosts.txt。
3. 将hosts文件放置到每台计算机设计好的目录中。根据不同的操作系统，目录的位置也不相同。

hosts文件包含有一台计算机需要想要与之通信的主机条目，允许输入和主机名，FQDN或是其他静态地别名相关的IP地址。当然里面还有一个条目用于[loopback 地址](/The-Internet-Layer/#Special-IP-Address)，即127.0.0.1。这个loopbakc地址用于给TCP/IP诊断并且代表当前这台计算机。

一个hosts文件示例：

![c18b44dc38ee4716.svg](https://i.quantuminit.com/c18b44dc38ee4716.svg)

当一台计算机上的一个应用需要解析一个名字成一个IP地址的时候，系统首先比较它自己的名字和被请求的名字。如果不匹配，系统将会进入hosts文件中查找（如果存在）是否有该计算机名在里面。如果能够匹配到一个，返回这个IP地址到本地计算机。通过使用IP以及ARP传输技术两台计算机之间产生通信。

创建或编辑hosts文件时的一些要点：

- IP地址必须左对齐并且使用一个或多个空格将它与主机名分隔开
- 名字必须被至少一个空格分隔开
- 在单行上多余的名字将会是第一个名字的别名。
- 文件从上到下被解析（计算机读取）。使用第一个和IP地址关联的匹配。当匹配成功时，则停止解析。
- 因为是从上到下进行解析，所以应该将常用的名字放置在上方。这样子可以加速解析过程。
- 使用*#*开头后面跟文本来表示注释
- 记住hosts文件是静态的；当IP地址发生更改时，必须手动更改hosts文件。
- 尽管FQDNs被允许以及在存在hosts文件中，但是不鼓励在hosts文件这么使用它们并且导致管理员在诊断时造成问题。控制hosts文件的管理员不能控制远程网络上的地址的分配以及主机名。

## DNS Name Resolution

DNS 存储名字解析在一台或多台特殊的服务器中。DNS服务器为网络提供名字解析服务。

![818cd5af384348c7.svg](https://i.quantuminit.com/818cd5af384348c7.svg)

上图中的DNS服务器的优点之一，为本地网络以及提供单一的DNS配置点以及高校的利用网络资源。然而并未为更大型网络基础设施的提供去中心化管理，以及不能够有效地运行一个含有网络上每个主机的IP地址记录的数据库。即使可以，但是在单台DNS服务器上维护所有互联网上的数据库是禁止的。

更好的方式是然每个办公室或学术机构配置运行一台本地的名字服务器，然后为所有的名字服务器提供能够与彼此之间进行通信的方式。当某个DNS客户端发送名字解析请求到名字解析服务器的时候，名字服务器按如下的方式之一进行工作：

- 如果名字服务器能够在自己的地址数据库中找到请求的地址，则立即发送这个地址给客户端。
- 如果服务器不能在自己的数据库记录中找到地址，则向其他名字服务器查找该地址然后发送该地址给客户端。

![35d10c4a3a6b449c.svg](https://i.quantuminit.com/35d10c4a3a6b449c.svg)
